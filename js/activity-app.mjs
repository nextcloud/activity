(function(){"use strict";try{if(typeof document<"u"){var i=document.createElement("style");i.appendChild(document.createTextNode(".activity-group__heading[data-v-2cedecff]{line-height:1.5;margin-block:30px 12px}.activity-group__heading[data-v-2cedecff]:first-of-type{margin-block-start:0}.activity-app[data-v-9b1face9]{display:flex;flex-direction:column;overflow:hidden}.activity-app__empty-content[data-v-9b1face9]{height:100%}.activity-app__loading-indicator[data-v-9b1face9]{color:var(--color-text-maxcontrast);justify-self:center;margin-block:30px 6px;text-align:center}.activity-app__container[data-v-9b1face9]{display:flex;flex-direction:column;height:100%;width:min(100%,924px);max-width:924px;margin:0 auto;padding-inline:12px;overflow-y:scroll}.activity-app__heading[data-v-9b1face9]{font-weight:700;font-size:20px;line-height:44px;margin-top:1px;margin-inline:calc(2 * var(--app-navigation-padding, 8px) + 44px) var(--app-navigation-padding, 8px)}.app-activity .settings-link{max-width:100%}.app-activity .app-navigation-entry.active .navigation-icon{filter:var(--primary-invert-if-dark)}.app-activity .app-navigation-entry:not(.active) .navigation-icon{filter:var(--background-invert-if-dark)}.app-activity .navigation-icon{height:16px;width:16px}")),document.head.appendChild(i)}}catch(a){console.error("vite-plugin-css-injected-by-js",a)}})();
import{_ as T,l as N,u as $,a as q,N as B,b as Y,c as F,g as D,d as G,e as J,f as K,h as P,i as O,j as Q}from"./NcUserBubble-B3Jad98g-CgpgqKNE.chunk.mjs";import{d as x,r as W,c as p,o as e,w as v,a as m,u as t,b as L,t as a,e as f,f as k,g as b,F as V,h as j,i as w,j as X,k as tt,l as H,n as at,m as it,p as I,q as et,s as nt}from"./preload-helper-RVLnSFSK.chunk.mjs";import{N as st,a as lt,s as U,b as ot,c as ct,d as rt,e as vt,f as ut}from"./index-hZPKu-D6-CyBKOb0_.chunk.mjs";import{m as S,_ as dt,N as M,A as pt}from"./ActivityComponent.vue_vue_type_script_setup_true_lang-Ctau26Qh.chunk.mjs";import{l as R}from"./logger-DAcBErzr.chunk.mjs";import"./_commonjsHelpers-Cqwegr3R.chunk.mjs";const z="activity";const yt=x({__name:"ActivityApp",setup(y){return(u,s)=>{const d=W("router-view");return e(),p(t(st),{"app-name":"activity"},{default:v(()=>[m(d,{name:"navigation"}),m(d)]),_:1})}}}),mt=["title"],ft=x({__name:"ActivityGroup",props:{activities:{}},setup(y){const u=y,s=L(()=>{const n=S(),l=S().subtract(1,"day"),i=S(u.activities[0].datetime);return i.isSame(n,"day")?a("activity","Today"):i.isSame(l,"day")?a("activity","Yesterday"):i.format("LL")}),d=L(()=>{const n=S(u.activities[0].datetime).format("LL");return n!==s.value?n:void 0});return(n,l)=>(e(),f(V,null,[k("h2",{class:"activity-group__heading",title:d.value},b(s.value),9,mt),k("ul",null,[(e(!0),f(V,null,j(y.activities,i=>(e(),p(dt,{key:i.id,activity:i,"show-previews":!0},null,8,["activity"]))),128))])],64))}}),gt=T(ft,[["__scopeId","data-v-2cedecff"]]),ht='<svg viewBox="0 0 32 32" height="32" width="32" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="m8 22 1-7H4l9-13h2l-1 8h6L10 22H8Z" style="fill-rule:nonzero" transform="matrix(1.5 0 0 1.5 -2 -2)"/></svg>',_t={class:"activity-app__heading"},wt={key:1,class:"activity-app__loading-indicator"},kt=x({__name:"ActivityAppFeed",props:{filter:{default:"all"}},setup(y){const u=N(z,"navigationList"),s=$(),d=y,n=w(!1),l=w(!0),i=w([]),A=w(),c=w();q(c,async()=>{l.value&&await C()},{distance:100});const _=L(()=>{const o={};for(const g of i.value){const h=S(g.datetime).format("LL");o[h]===void 0?o[h]=[g]:o[h].push(g)}return o}),r=L(()=>u.find(o=>o.id===s.params.filter).name);async function C(){if(!n.value)try{const o=A.value??"0";n.value=!0;const g=await F.get(D("apps/activity/api/v2/activity/{filter}?format=json&previews=true&since={since}",{filter:d.filter,since:o}));i.value.push(...g.data.ocs.data.map(h=>new pt(h))),A.value=g.headers["x-activity-last-given"],l.value=!0,at(async()=>{c.value&&c.value.clientHeight===c.value.scrollHeight&&await C()})}catch(o){if(G.isAxiosError(o)&&o.response?.status===304){l.value=!1;return}R.error(o),U(a("activity","Could not load activities"))}finally{n.value=!1}}return X(()=>{C()}),tt(d,()=>{i.value=[],A.value=void 0,C()}),(o,g)=>(e(),p(t(lt),{class:"activity-app"},{default:v(()=>[k("h1",_t,b(r.value),1),l.value&&i.value.length===0?(e(),p(t(M),{key:0,class:"activity-app__empty-content",name:t(a)("activity","Loading activities"),description:t(a)("activity","This stream will show events like additions, changes & shares")},{icon:v(()=>[m(t(B),{size:36})]),_:1},8,["name","description"])):i.value.length===0?(e(),p(t(M),{key:1,class:"activity-app__empty-content",name:t(a)("activity","No activity yet"),description:t(a)("activity","This stream will show events like additions, changes & shares")},{icon:v(()=>[m(t(Y),{svg:t(ht),size:36},null,8,["svg"])]),_:1},8,["name","description"])):H("",!0),k("div",{ref_key:"container",ref:c,class:"activity-app__container"},[(e(!0),f(V,null,j(_.value,(h,Z)=>(e(),p(gt,{key:Z,activities:h},null,8,["activities"]))),128)),l.value&&i.value.length>0?(e(),p(t(B),{key:0,name:t(a)("activity","Loading more activities"),size:64,class:"activity-app__loading-indicator"},null,8,["name"])):!l.value&&i.value.length>0?(e(),f("div",wt,b(t(a)("activity","No more activities.")),1)):H("",!0)],512)]),_:1}))}}),bt=T(kt,[["__scopeId","data-v-9b1face9"]]),At={name:"ContentCopyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},St=["aria-hidden","aria-label"],Lt=["fill","width","height"],Ct={d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},Vt={key:0};function Ht(y,u,s,d,n,l){return e(),f("span",it(y.$attrs,{"aria-hidden":s.title?null:"true","aria-label":s.title,class:"material-design-icon content-copy-icon",role:"img",onClick:u[0]||(u[0]=i=>y.$emit("click",i))}),[(e(),f("svg",{fill:s.fillColor,class:"material-design-icon__svg",width:s.size,height:s.size,viewBox:"0 0 24 24"},[k("path",Ct,[s.title?(e(),f("title",Vt,b(s.title),1)):H("",!0)])],8,Lt))],16,St)}const xt=T(At,[["render",Ht]]),zt=["src"],Nt=x({__name:"ActivityAppNavigation",setup(y){const{rssLink:u,personalSettingsLink:s}=N(z,"settings"),d=N(z,"navigationList"),n=w(u),l=L(()=>!!n.value);async function i(){try{const{data:c}=await F.post(P("/apps/activity/settings/feed"),{enable:!l.value});n.value=c.data.rsslink}catch(c){U(a("activity","Could not enable RSS link")),R.error(c)}}async function A(){try{window.navigator.clipboard.writeText(n.value),ut(a("activity","RSS link copied to clipboard"))}catch(c){R.debug(c),window.prompt(a("activity","Could not copy the RSS link, please copy manually:"),n.value)}}return(c,_)=>(e(),p(t(vt),{"aria-label":t(a)("activity","Activity")},{list:v(()=>[(e(!0),f(V,null,j(t(d),r=>(e(),p(t(rt),{key:r.id,"data-navigation":r.id,to:r.id,name:r.name},et({_:2},[r.icon?{name:"icon",fn:v(()=>[k("img",{alt:"",src:r.icon,class:"navigation-icon",role:"presentation"},null,8,zt)]),key:"0"}:void 0]),1032,["data-navigation","to","name"]))),128))]),footer:v(()=>[m(t(ot),{name:t(a)("activity","Activity settings")},{default:v(()=>[m(t(J),{type:"switch",modelValue:l.value,"onUpdate:modelValue":[_[0]||(_[0]=r=>l.value=r),i]},{default:v(()=>[I(b(t(a)("activity","Enable RSS feed")),1)]),_:1},8,["modelValue"]),l.value?(e(),p(t(ct),{key:0,modelValue:n.value,"onUpdate:modelValue":_[1]||(_[1]=r=>n.value=r),label:t(a)("activity","RSS feed"),"show-trailing-button":!0,"trailing-button-label":t(a)("activity","Copy RSS feed link"),readonly:"readonly",onTrailingButtonClick:A},{"trailing-button-icon":v(()=>[m(xt,{size:20})]),_:1},8,["modelValue","label","trailing-button-label"])):H("",!0),m(t(K),{class:"settings-link",href:t(s),title:t(a)("activity","Personal notification settings"),variant:"tertiary"},{default:v(()=>[I(b(t(a)("activity","Personal notification settings")),1)]),_:1},8,["href","title"])]),_:1},8,["name"])]),_:1},8,["aria-label"]))}}),Rt=[{path:"/",name:"root",redirect:{path:"/all"}},{path:"/:filter?",components:{default:bt,navigation:Nt},props:{default:!0}}],Tt=O({history:Q(P("/apps/activity")),linkActiveClass:"active",routes:Rt}),E=nt(yt);E.use(Tt),E.mount("#content");
//# sourceMappingURL=activity-app.mjs.map
